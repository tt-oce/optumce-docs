"""Initialization"""
from OptumGX import *
import numpy as np
# Application
gx = GX()
# Project
prj = gx.create_project('Arbitrary material data')
prj.get_current_model().delete()
# Model (2D)
model2d = prj.create_model('2D model',model_type='plane_strain')
# Stage
stage1 = model2d.create_stage('stage 1')

"""Constants"""
B = 4 #m
E = 40 #MPa
q = -1 #kN/m^2
"""Geometry"""

model2d.add_rectangle(p0=[0,0],p1=[11,-5])
model2d.add_rectangle(p0=[0,0],p1=[B/2,1])


"""Materials"""
cu_map = ParameterMap(
[[ 2.    ,  0.    ,  1.    , 50.548 ],
 [ 1.785 ,  0.    ,  0.783 , 47.444 ],
 [ 2.    ,  0.    ,  0.667 , 55.074 ],
 [ 1.6667,  0.    ,  1.    , 47.398 ],
 [ 2.    ,  0.    ,  0.333 , 59.481 ],
 [ 1.785 ,  0.    ,  0.217 , 56.275 ],
 [ 2.    ,  0.    ,  0.    , 62.736 ],
 [ 1.6667,  0.    ,  0.    , 56.639 ],
 [ 0.3333,  0.    ,  0.    , 34.833 ],
 [ 0.2151,  0.    ,  0.217 , 39.318 ],
 [ 0.    ,  0.    ,  0.    , 37.735 ],
 [ 0.    ,  0.    ,  0.333 , 49.557 ],
 [ 0.    ,  0.    ,  0.667 , 62.669 ],
 [ 0.215 ,  0.    ,  0.783 , 59.746 ],
 [ 0.    ,  0.    ,  1.    , 74.451 ],
 [ 0.3333,  0.    ,  1.    , 71.176 ],
 [ 1.7388,  0.    ,  0.5   , 44.368 ],
 [ 0.6667,  0.    ,  0.    , 34.199 ],
 [ 0.4911,  0.    ,  0.255 , 44.972 ],
 [ 1.5108,  0.    ,  0.253 , 54.467 ],
 [ 1.3333,  0.    ,  0.    , 46.765 ],
 [ 1.    ,  0.    ,  0.    , 35.463 ],
 [ 0.8399,  0.    ,  0.333 , 47.244 ],
 [ 1.1929,  0.    ,  0.301 , 52.303 ],
 [ 0.2613,  0.    ,  0.5   , 44.037 ],
 [ 0.4895,  0.    ,  0.747 , 58.252 ],
 [ 0.6667,  0.    ,  1.    , 63.342 ],
 [ 1.3333,  0.    ,  1.    , 47.916 ],
 [ 1.5092,  0.    ,  0.745 , 53.037 ],
 [ 0.8085,  0.    ,  0.699 , 57.054 ],
 [ 1.    ,  0.    ,  1.    , 50.817 ],
 [ 1.1615,  0.    ,  0.666 , 52.595 ],
 [ 0.5959,  0.    ,  0.501 , 47.336 ],
 [ 1.4051,  0.    ,  0.497 , 47.673 ],
 [11.    ,  0.    , -4.643 , 61.634 ],
 [10.76  ,  0.    , -4.762 , 61.894 ],
 [11.    ,  0.    , -5.    , 64.944 ],
 [10.633 ,  0.    , -5.    , 63.231 ],
 [ 0.    ,  0.    , -0.357 , 58.095 ],
 [ 0.2262,  0.    , -0.224 , 56.697 ],
 [10.637 ,  0.    ,  0.    , 12.335 ],
 [10.762 ,  0.    , -0.238 , 14.859 ],
 [11.    ,  0.    ,  0.    , 12.337 ],
 [11.    ,  0.    , -0.357 , 16.127 ],
 [ 0.3667,  0.    , -5.    , 89.309 ],
 [ 0.24  ,  0.    , -4.762 , 86.501 ],
 [ 0.    ,  0.    , -5.    , 91.376 ],
 [ 0.    ,  0.    , -4.643 , 85.103 ],
 [ 2.1918,  0.    , -0.29  , 32.314 ],
 [ 2.3628,  0.    ,  0.    , 12.058 ],
 [ 1.9478,  0.    , -0.309 , 62.322 ],
 [ 1.7663,  0.    , -0.209 , 74.98  ],
 [ 6.354 ,  0.    ,  0.    , 11.771 ],
 [ 6.5   ,  0.    , -0.314 , 15.563 ],
 [ 6.646 ,  0.    ,  0.    , 11.842 ],
 [ 0.5   ,  0.    , -0.253 , 57.697 ],
 [ 0.8239,  0.    , -0.303 , 59.821 ],
 [ 1.164 ,  0.    , -0.306 , 62.629 ],
 [10.701 ,  0.    , -0.535 , 18.016 ],
 [11.    ,  0.    , -0.714 , 19.919 ],
 [11.    ,  0.    , -4.286 , 57.196 ],
 [10.7   ,  0.    , -4.464 , 58.65  ],
 [10.685 ,  0.    , -0.89  , 21.789 ],
 [11.    ,  0.    , -1.071 , 23.708 ],
 [11.    ,  0.    , -3.929 , 53.426 ],
 [10.685 ,  0.    , -4.109 , 55.53  ],
 [10.686 ,  0.    , -1.25  , 25.607 ],
 [11.    ,  0.    , -1.429 , 27.489 ],
 [11.    ,  0.    , -3.571 , 49.918 ],
 [10.686 ,  0.    , -3.75  , 51.697 ],
 [10.686 ,  0.    , -1.608 , 29.391 ],
 [11.    ,  0.    , -1.786 , 31.266 ],
 [11.    ,  0.    , -3.214 , 46.199 ],
 [10.686 ,  0.    , -3.392 , 48.031 ],
 [10.686 ,  0.    , -1.965 , 33.158 ],
 [11.    ,  0.    , -2.143 , 35.023 ],
 [11.    ,  0.    , -2.857 , 42.496 ],
 [10.686 ,  0.    , -3.035 , 44.355 ],
 [10.686 ,  0.    , -2.322 , 36.914 ],
 [11.    ,  0.    , -2.5   , 38.763 ],
 [10.686 ,  0.    , -2.678 , 40.635 ],
 [ 0.2999,  0.    , -4.464 , 82.408 ],
 [ 0.    ,  0.    , -4.286 , 83.88  ],
 [ 0.    ,  0.    , -0.714 , 61.722 ],
 [ 0.2929,  0.    , -0.516 , 60.054 ],
 [ 0.3148,  0.    , -4.109 , 83.068 ],
 [ 0.    ,  0.    , -3.929 , 83.795 ],
 [ 0.    ,  0.    , -1.071 , 64.694 ],
 [ 0.3125,  0.    , -0.878 , 63.369 ],
 [ 0.3142,  0.    , -3.75  , 82.166 ],
 [ 0.    ,  0.    , -3.571 , 82.854 ],
 [ 0.    ,  0.    , -1.429 , 67.241 ],
 [ 0.3137,  0.    , -1.246 , 66.096 ],
 [ 0.3142,  0.    , -3.392 , 80.797 ],
 [ 0.    ,  0.    , -3.214 , 80.458 ],
 [ 0.    ,  0.    , -1.786 , 69.61  ],
 [ 0.3142,  0.    , -1.607 , 68.457 ],
 [ 0.3142,  0.    , -3.035 , 78.807 ],
 [ 0.    ,  0.    , -2.857 , 77.489 ],
 [ 0.    ,  0.    , -2.143 , 71.961 ],
 [ 0.3142,  0.    , -1.965 , 70.745 ],
 [ 0.3142,  0.    , -2.678 , 76.032 ],
 [ 0.    ,  0.    , -2.5   , 74.641 ],
 [ 0.3142,  0.    , -2.321 , 73.126 ],
 [ 2.5381,  0.    , -0.309 , 23.653 ],
 [ 2.7256,  0.    ,  0.    , 15.643 ],
 [10.274 ,  0.    ,  0.    , 12.327 ],
 [10.464 ,  0.    , -0.303 , 15.553 ],
 [ 2.9037,  0.    , -0.314 , 19.615 ],
 [ 3.0884,  0.    ,  0.    , 15.068 ],
 [ 9.912 ,  0.    ,  0.    , 12.313 ],
 [10.103 ,  0.    , -0.319 , 15.72  ],
 [ 3.2687,  0.    , -0.314 , 19.03  ],
 [ 3.4513,  0.    ,  0.    , 13.594 ],
 [ 9.549 ,  0.    ,  0.    , 12.294 ],
 [ 9.732 ,  0.    , -0.315 , 15.666 ],
 [ 3.6323,  0.    , -0.314 , 17.983 ],
 [ 3.8141,  0.    ,  0.    , 12.674 ],
 [ 9.186 ,  0.    ,  0.    , 12.267 ],
 [ 9.368 ,  0.    , -0.314 , 15.653 ],
 [ 3.9954,  0.    , -0.314 , 17.157 ],
 [ 4.177 ,  0.    ,  0.    , 12.121 ],
 [ 8.823 ,  0.    ,  0.    , 12.232 ],
 [ 9.005 ,  0.    , -0.314 , 15.642 ],
 [ 4.358 ,  0.    , -0.314 , 16.566 ],
 [ 4.54  ,  0.    ,  0.    , 11.812 ],
 [ 8.46  ,  0.    ,  0.    , 12.189 ],
 [ 8.642 ,  0.    , -0.314 , 15.629 ],
 [ 4.721 ,  0.    , -0.314 , 16.162 ],
 [ 4.903 ,  0.    ,  0.    , 11.664 ],
 [ 8.097 ,  0.    ,  0.    , 12.137 ],
 [ 8.279 ,  0.    , -0.314 , 15.614 ],
 [ 5.084 ,  0.    , -0.314 , 15.897 ],
 [ 5.265 ,  0.    ,  0.    , 11.62  ],
 [ 7.735 ,  0.    ,  0.    , 12.074 ],
 [ 7.916 ,  0.    , -0.314 , 15.598 ],
 [ 5.447 ,  0.    , -0.314 , 15.731 ],
 [ 5.628 ,  0.    ,  0.    , 11.639 ],
 [ 7.372 ,  0.    ,  0.    , 12.002 ],
 [ 7.553 ,  0.    , -0.314 , 15.58  ],
 [ 5.808 ,  0.    , -0.314 , 15.634 ],
 [ 5.991 ,  0.    ,  0.    , 11.696 ],
 [ 7.009 ,  0.    ,  0.    , 11.923 ],
 [ 7.192 ,  0.    , -0.314 , 15.567 ],
 [ 6.162 ,  0.    , -0.314 , 15.582 ],
 [ 6.838 ,  0.    , -0.314 , 15.56  ],
 [10.46  ,  0.    , -4.697 , 61.849 ],
 [10.267 ,  0.    , -5.    , 64.471 ],
 [ 0.7333,  0.    , -5.    , 89.306 ],
 [ 0.5404,  0.    , -4.697 , 85.65  ],
 [10.094 ,  0.    , -4.681 , 61.261 ],
 [ 9.9   ,  0.    , -5.    , 64.497 ],
 [ 1.1   ,  0.    , -5.    , 87.532 ],
 [ 0.9056,  0.    , -4.681 , 83.938 ],
 [ 9.719 ,  0.    , -4.685 , 61.36  ],
 [ 9.533 ,  0.    , -5.    , 64.537 ],
 [ 1.4667,  0.    , -5.    , 85.619 ],
 [ 1.2805,  0.    , -4.685 , 82.49  ],
 [ 9.351 ,  0.    , -4.686 , 61.464 ],
 [ 9.167 ,  0.    , -5.    , 64.655 ],
 [ 1.8333,  0.    , -5.    , 83.701 ],
 [ 1.6489,  0.    , -4.686 , 80.855 ],
 [ 8.984 ,  0.    , -4.686 , 61.567 ],
 [ 8.8   ,  0.    , -5.    , 64.755 ],
 [ 2.2   ,  0.    , -5.    , 81.696 ],
 [ 2.0159,  0.    , -4.686 , 79.087 ],
 [ 8.617 ,  0.    , -4.686 , 61.712 ],
 [ 8.433 ,  0.    , -5.    , 64.907 ],
 [ 2.5667,  0.    , -5.    , 79.711 ],
 [ 2.3827,  0.    , -4.686 , 77.272 ],
 [ 8.251 ,  0.    , -4.686 , 61.892 ],
 [ 8.067 ,  0.    , -5.    , 65.088 ],
 [ 2.9333,  0.    , -5.    , 77.774 ],
 [ 2.7494,  0.    , -4.686 , 75.453 ],
 [ 7.884 ,  0.    , -4.686 , 62.115 ],
 [ 7.7   ,  0.    , -5.    , 65.319 ],
 [ 3.3   ,  0.    , -5.    , 75.943 ],
 [ 3.116 ,  0.    , -4.686 , 73.684 ],
 [ 7.517 ,  0.    , -4.686 , 62.393 ],
 [ 7.333 ,  0.    , -5.    , 65.604 ],
 [ 3.6667,  0.    , -5.    , 74.251 ],
 [ 3.4827,  0.    , -4.686 , 72.011 ],
 [ 7.151 ,  0.    , -4.686 , 62.731 ],
 [ 6.967 ,  0.    , -5.    , 65.955 ],
 [ 4.033 ,  0.    , -5.    , 72.722 ],
 [ 3.8494,  0.    , -4.686 , 70.464 ],
 [ 6.784 ,  0.    , -4.686 , 63.142 ],
 [ 6.6   ,  0.    , -5.    , 66.383 ],
 [ 4.4   ,  0.    , -5.    , 71.363 ],
 [ 4.216 ,  0.    , -4.686 , 69.061 ],
 [ 6.417 ,  0.    , -4.686 , 63.637 ],
 [ 6.233 ,  0.    , -5.    , 66.901 ],
 [ 4.767 ,  0.    , -5.    , 70.173 ],
 [ 4.583 ,  0.    , -4.686 , 67.81  ],
 [ 6.051 ,  0.    , -4.686 , 64.227 ],
 [ 5.867 ,  0.    , -5.    , 67.524 ],
 [ 5.133 ,  0.    , -5.    , 69.146 ],
 [ 4.949 ,  0.    , -4.686 , 66.708 ],
 [ 5.684 ,  0.    , -4.686 , 64.928 ],
 [ 5.5   ,  0.    , -5.    , 68.267 ],
 [ 5.317 ,  0.    , -4.686 , 65.751 ],
 [ 2.0671,  0.    , -0.588 , 49.382 ],
 [ 1.7159,  0.    , -0.525 , 71.479 ],
 [ 1.4867,  0.    , -0.277 , 66.892 ],
 [ 0.6291,  0.    , -0.618 , 61.984 ],
 [ 0.9969,  0.    , -0.614 , 63.905 ],
 [10.347 ,  0.    , -0.677 , 19.523 ],
 [10.345 ,  0.    , -4.322 , 57.582 ],
 [10.372 ,  0.    , -1.069 , 23.695 ],
 [10.371 ,  0.    , -3.93  , 53.631 ],
 [10.372 ,  0.    , -1.429 , 27.508 ],
 [10.372 ,  0.    , -3.571 , 49.967 ],
 [10.372 ,  0.    , -1.787 , 31.298 ],
 [10.372 ,  0.    , -3.213 , 46.185 ],
 [10.372 ,  0.    , -2.144 , 35.06  ],
 [10.372 ,  0.    , -2.856 , 42.515 ],
 [10.372 ,  0.    , -2.5   , 38.801 ],
 [ 0.6551,  0.    , -4.322 , 80.343 ],
 [ 0.6287,  0.    , -3.93  , 79.728 ],
 [ 0.6215,  0.    , -1.045 , 65.18  ],
 [ 0.6284,  0.    , -3.571 , 78.662 ],
 [ 0.629 ,  0.    , -1.42  , 67.448 ],
 [ 0.6284,  0.    , -3.213 , 77.664 ],
 [ 0.6284,  0.    , -1.784 , 69.536 ],
 [ 0.6284,  0.    , -2.856 , 76.538 ],
 [ 0.6284,  0.    , -2.143 , 71.706 ],
 [ 0.6284,  0.    , -2.5   , 74.629 ],
 [ 2.3736,  0.    , -0.608 , 32.533 ],
 [ 2.7214,  0.    , -0.625 , 26.109 ],
 [ 3.0853,  0.    , -0.628 , 24.263 ],
 [ 9.924 ,  0.    , -0.634 , 19.072 ],
 [ 3.45  ,  0.    , -0.628 , 23.208 ],
 [ 9.551 ,  0.    , -0.63  , 19.043 ],
 [ 3.8136,  0.    , -0.628 , 22.203 ],
 [ 9.186 ,  0.    , -0.628 , 19.03  ],
 [ 4.177 ,  0.    , -0.628 , 21.386 ],
 [ 8.823 ,  0.    , -0.628 , 19.041 ],
 [ 4.54  ,  0.    , -0.628 , 20.753 ],
 [ 8.46  ,  0.    , -0.628 , 19.056 ],
 [ 4.903 ,  0.    , -0.628 , 20.278 ],
 [ 8.097 ,  0.    , -0.628 , 19.078 ],
 [ 5.265 ,  0.    , -0.628 , 19.927 ],
 [ 7.735 ,  0.    , -0.628 , 19.103 ],
 [ 5.627 ,  0.    , -0.628 , 19.67  ],
 [ 7.373 ,  0.    , -0.628 , 19.141 ],
 [ 5.984 ,  0.    , -0.628 , 19.485 ],
 [ 6.331 ,  0.    , -0.628 , 19.355 ],
 [ 7.016 ,  0.    , -0.628 , 19.194 ],
 [ 6.671 ,  0.    , -0.628 , 19.262 ],
 [ 9.916 ,  0.    , -4.366 , 58.061 ],
 [ 1.0845,  0.    , -4.366 , 78.915 ],
 [ 9.538 ,  0.    , -4.369 , 58.235 ],
 [ 1.4621,  0.    , -4.369 , 77.824 ],
 [ 9.168 ,  0.    , -4.372 , 58.338 ],
 [ 1.8316,  0.    , -4.372 , 76.312 ],
 [ 8.801 ,  0.    , -4.372 , 58.486 ],
 [ 2.1986,  0.    , -4.372 , 74.687 ],
 [ 8.435 ,  0.    , -4.372 , 58.653 ],
 [ 2.5653,  0.    , -4.372 , 72.98  ],
 [ 8.068 ,  0.    , -4.372 , 58.868 ],
 [ 2.932 ,  0.    , -4.372 , 71.281 ],
 [ 7.701 ,  0.    , -4.372 , 59.131 ],
 [ 3.2987,  0.    , -4.372 , 69.636 ],
 [ 7.335 ,  0.    , -4.372 , 59.452 ],
 [ 3.6654,  0.    , -4.372 , 68.085 ],
 [ 6.968 ,  0.    , -4.372 , 59.841 ],
 [ 4.032 ,  0.    , -4.372 , 66.653 ],
 [ 6.601 ,  0.    , -4.372 , 60.307 ],
 [ 4.399 ,  0.    , -4.372 , 65.356 ],
 [ 6.235 ,  0.    , -4.372 , 60.862 ],
 [ 4.765 ,  0.    , -4.372 , 64.197 ],
 [ 5.868 ,  0.    , -4.372 , 61.516 ],
 [ 5.133 ,  0.    , -4.372 , 63.175 ],
 [ 5.5   ,  0.    , -4.372 , 62.284 ],
 [ 1.8744,  0.    , -0.877 , 60.576 ],
 [ 1.3435,  0.    , -0.589 , 66.901 ],
 [ 0.873 ,  0.    , -0.894 , 65.035 ],
 [10.078 ,  0.    , -0.921 , 22.124 ],
 [10.075 ,  0.    , -4.079 , 55.15  ],
 [10.058 ,  0.    , -1.243 , 25.552 ],
 [10.057 ,  0.    , -3.757 , 51.785 ],
 [10.058 ,  0.    , -1.606 , 29.41  ],
 [10.058 ,  0.    , -3.393 , 48.152 ],
 [10.057 ,  0.    , -1.966 , 33.211 ],
 [10.057 ,  0.    , -3.034 , 44.422 ],
 [10.057 ,  0.    , -2.677 , 40.675 ],
 [10.057 ,  0.    , -2.322 , 36.964 ],
 [ 0.9246,  0.    , -4.079 , 76.87  ],
 [ 0.943 ,  0.    , -3.757 , 75.543 ],
 [ 0.9649,  0.    , -1.216 , 66.829 ],
 [ 0.9425,  0.    , -3.393 , 74.551 ],
 [ 0.9446,  0.    , -1.597 , 68.453 ],
 [ 0.9426,  0.    , -3.034 , 73.74  ],
 [ 0.9426,  0.    , -1.962 , 70.728 ],
 [ 0.9426,  0.    , -2.321 , 72.492 ],
 [ 0.9426,  0.    , -2.678 , 73.127 ],
 [ 2.2074,  0.    , -0.91  , 46.798 ],
 [ 2.5434,  0.    , -0.93  , 32.988 ],
 [ 2.9016,  0.    , -0.941 , 29.844 ],
 [ 3.2667,  0.    , -0.942 , 28.455 ],
 [ 9.737 ,  0.    , -0.978 , 22.756 ],
 [ 3.6313,  0.    , -0.943 , 27.25  ],
 [ 9.361 ,  0.    , -0.943 , 22.404 ],
 [ 3.995 ,  0.    , -0.943 , 26.234 ],
 [ 9.003 ,  0.    , -0.943 , 22.426 ],
 [ 4.358 ,  0.    , -0.943 , 25.399 ],
 [ 8.641 ,  0.    , -0.943 , 22.464 ],
 [ 4.721 ,  0.    , -0.943 , 24.73  ],
 [ 8.279 ,  0.    , -0.943 , 22.514 ],
 [ 5.084 ,  0.    , -0.943 , 24.2   ],
 [ 7.916 ,  0.    , -0.943 , 22.573 ],
 [ 5.446 ,  0.    , -0.943 , 23.784 ],
 [ 7.554 ,  0.    , -0.943 , 22.652 ],
 [ 5.806 ,  0.    , -0.943 , 23.461 ],
 [ 6.158 ,  0.    , -0.943 , 23.213 ],
 [ 7.194 ,  0.    , -0.943 , 22.752 ],
 [ 6.844 ,  0.    , -0.943 , 22.872 ],
 [ 6.501 ,  0.    , -0.943 , 23.023 ],
 [ 9.729 ,  0.    , -4.021 , 54.692 ],
 [ 1.2706,  0.    , -4.021 , 74.027 ],
 [ 9.347 ,  0.    , -4.057 , 55.075 ],
 [ 1.653 ,  0.    , -4.057 , 73.412 ],
 [ 8.984 ,  0.    , -4.057 , 55.231 ],
 [ 2.0157,  0.    , -4.057 , 72.011 ],
 [ 8.618 ,  0.    , -4.057 , 55.386 ],
 [ 2.3816,  0.    , -4.057 , 70.418 ],
 [ 8.252 ,  0.    , -4.057 , 55.585 ],
 [ 2.7481,  0.    , -4.057 , 68.778 ],
 [ 7.885 ,  0.    , -4.057 , 55.831 ],
 [ 3.1147,  0.    , -4.057 , 67.156 ],
 [ 7.519 ,  0.    , -4.057 , 56.13  ],
 [ 3.4814,  0.    , -4.057 , 65.601 ],
 [ 7.152 ,  0.    , -4.057 , 56.492 ],
 [ 3.8481,  0.    , -4.057 , 64.146 ],
 [ 6.785 ,  0.    , -4.057 , 56.925 ],
 [ 4.215 ,  0.    , -4.057 , 62.811 ],
 [ 6.419 ,  0.    , -4.057 , 57.44  ],
 [ 4.581 ,  0.    , -4.057 , 61.606 ],
 [ 6.052 ,  0.    , -4.057 , 58.047 ],
 [ 4.948 ,  0.    , -4.057 , 60.531 ],
 [ 5.316 ,  0.    , -4.057 , 59.584 ],
 [ 5.684 ,  0.    , -4.057 , 58.758 ],
 [ 1.5255,  0.    , -0.867 , 68.972 ],
 [ 1.1823,  0.    , -0.906 , 66.643 ],
 [ 9.747 ,  0.    , -1.406 , 27.316 ],
 [ 9.745 ,  0.    , -3.593 , 50.24  ],
 [ 9.742 ,  0.    , -1.781 , 31.295 ],
 [ 9.742 ,  0.    , -3.218 , 46.358 ],
 [ 9.743 ,  0.    , -2.856 , 42.625 ],
 [ 9.743 ,  0.    , -2.499 , 38.873 ],
 [ 9.743 ,  0.    , -2.142 , 35.114 ],
 [ 1.2547,  0.    , -3.593 , 71.464 ],
 [ 1.2761,  0.    , -1.405 , 68.366 ],
 [ 1.258 ,  0.    , -3.218 , 70.089 ],
 [ 1.2577,  0.    , -1.775 , 68.954 ],
 [ 1.2568,  0.    , -2.14  , 68.66  ],
 [ 1.2568,  0.    , -2.499 , 68.671 ],
 [ 1.2568,  0.    , -2.857 , 69.169 ],
 [ 2.0182,  0.    , -1.206 , 53.128 ],
 [ 2.3596,  0.    , -1.233 , 44.118 ],
 [ 2.7158,  0.    , -1.249 , 35.065 ],
 [ 3.0815,  0.    , -1.256 , 33.744 ],
 [ 3.4478,  0.    , -1.257 , 32.313 ],
 [ 9.488 ,  0.    , -1.239 , 25.561 ],
 [ 3.8126,  0.    , -1.257 , 31.096 ],
 [ 9.178 ,  0.    , -1.257 , 25.787 ],
 [ 4.176 ,  0.    , -1.257 , 30.073 ],
 [ 8.82  ,  0.    , -1.257 , 25.838 ],
 [ 4.539 ,  0.    , -1.257 , 29.224 ],
 [ 8.459 ,  0.    , -1.257 , 25.91  ],
 [ 4.902 ,  0.    , -1.257 , 28.526 ],
 [ 8.097 ,  0.    , -1.257 , 25.995 ],
 [ 5.265 ,  0.    , -1.257 , 27.956 ],
 [ 7.735 ,  0.    , -1.257 , 26.104 ],
 [ 5.626 ,  0.    , -1.257 , 27.494 ],
 [ 5.981 ,  0.    , -1.257 , 27.125 ],
 [ 7.374 ,  0.    , -1.257 , 26.24  ],
 [ 7.019 ,  0.    , -1.257 , 26.4   ],
 [ 6.671 ,  0.    , -1.257 , 26.596 ],
 [ 6.328 ,  0.    , -1.257 , 26.833 ],
 [ 9.479 ,  0.    , -3.76  , 52.047 ],
 [ 1.5209,  0.    , -3.76  , 70.518 ],
 [ 9.164 ,  0.    , -3.743 , 51.95  ],
 [ 1.8361,  0.    , -3.743 , 69.319 ],
 [ 8.801 ,  0.    , -3.743 , 52.095 ],
 [ 2.1992,  0.    , -3.743 , 67.829 ],
 [ 8.435 ,  0.    , -3.743 , 52.276 ],
 [ 2.5646,  0.    , -3.743 , 66.225 ],
 [ 8.069 ,  0.    , -3.743 , 52.499 ],
 [ 2.9309,  0.    , -3.743 , 64.605 ],
 [ 7.703 ,  0.    , -3.743 , 52.773 ],
 [ 3.2975,  0.    , -3.743 , 63.036 ],
 [ 7.336 ,  0.    , -3.743 , 53.104 ],
 [ 3.6641,  0.    , -3.743 , 61.552 ],
 [ 6.969 ,  0.    , -3.743 , 53.5   ],
 [ 4.031 ,  0.    , -3.743 , 60.18  ],
 [ 6.603 ,  0.    , -3.743 , 53.972 ],
 [ 4.397 ,  0.    , -3.743 , 58.931 ],
 [ 6.236 ,  0.    , -3.743 , 54.529 ],
 [ 4.764 ,  0.    , -3.743 , 57.81  ],
 [ 5.131 ,  0.    , -3.743 , 56.816 ],
 [ 5.499 ,  0.    , -3.743 , 55.942 ],
 [ 5.868 ,  0.    , -3.743 , 55.182 ],
 [ 1.6607,  0.    , -1.207 , 63.813 ],
 [ 1.3366,  0.    , -1.14  , 67.738 ],
 [ 9.405 ,  0.    , -1.584 , 29.254 ],
 [ 9.402 ,  0.    , -3.414 , 48.49  ],
 [ 9.429 ,  0.    , -3.033 , 44.51  ],
 [ 9.429 ,  0.    , -2.676 , 40.807 ],
 [ 9.429 ,  0.    , -2.319 , 37.053 ],
 [ 9.43  ,  0.    , -1.964 , 33.286 ],
 [ 1.5981,  0.    , -3.414 , 66.917 ],
 [ 1.5777,  0.    , -1.605 , 63.666 ],
 [ 1.5718,  0.    , -1.963 , 63.178 ],
 [ 1.5707,  0.    , -2.321 , 63.498 ],
 [ 1.5709,  0.    , -2.679 , 64.255 ],
 [ 1.5709,  0.    , -3.035 , 65.52  ],
 [ 2.1604,  0.    , -1.528 , 50.438 ],
 [ 2.5237,  0.    , -1.554 , 41.96  ],
 [ 2.8921,  0.    , -1.566 , 38.889 ],
 [ 3.2617,  0.    , -1.57  , 37.369 ],
 [ 3.6289,  0.    , -1.571 , 35.957 ],
 [ 3.9939,  0.    , -1.571 , 34.754 ],
 [ 9.004 ,  0.    , -1.569 , 29.158 ],
 [ 4.358 ,  0.    , -1.571 , 33.737 ],
 [ 8.64  ,  0.    , -1.572 , 29.281 ],
 [ 4.721 ,  0.    , -1.571 , 32.881 ],
 [ 8.278 ,  0.    , -1.571 , 29.371 ],
 [ 5.084 ,  0.    , -1.571 , 32.164 ],
 [ 7.916 ,  0.    , -1.571 , 29.503 ],
 [ 5.445 ,  0.    , -1.571 , 31.569 ],
 [ 5.803 ,  0.    , -1.571 , 31.079 ],
 [ 7.554 ,  0.    , -1.571 , 29.663 ],
 [ 7.196 ,  0.    , -1.571 , 29.853 ],
 [ 6.844 ,  0.    , -1.571 , 30.083 ],
 [ 6.498 ,  0.    , -1.571 , 30.355 ],
 [ 6.153 ,  0.    , -1.571 , 30.682 ],
 [ 8.991 ,  0.    , -3.431 , 48.795 ],
 [ 2.0094,  0.    , -3.431 , 65.365 ],
 [ 8.62  ,  0.    , -3.428 , 48.933 ],
 [ 2.3803,  0.    , -3.428 , 63.674 ],
 [ 8.253 ,  0.    , -3.429 , 49.144 ],
 [ 2.7475,  0.    , -3.429 , 62.025 ],
 [ 7.886 ,  0.    , -3.429 , 49.39  ],
 [ 3.1138,  0.    , -3.429 , 60.414 ],
 [ 7.52  ,  0.    , -3.429 , 49.687 ],
 [ 3.4803,  0.    , -3.429 , 58.885 ],
 [ 7.153 ,  0.    , -3.429 , 50.044 ],
 [ 3.847 ,  0.    , -3.429 , 57.467 ],
 [ 6.787 ,  0.    , -3.429 , 50.469 ],
 [ 4.214 ,  0.    , -3.429 , 56.173 ],
 [ 6.42  ,  0.    , -3.429 , 50.973 ],
 [ 4.58  ,  0.    , -3.429 , 55.009 ],
 [ 4.947 ,  0.    , -3.429 , 53.972 ],
 [ 5.315 ,  0.    , -3.429 , 53.058 ],
 [ 5.683 ,  0.    , -3.429 , 52.258 ],
 [ 6.051 ,  0.    , -3.429 , 51.566 ],
 [ 1.8513,  0.    , -1.483 , 58.064 ],
 [ 9.138 ,  0.    , -3.165 , 45.998 ],
 [ 9.117 ,  0.    , -2.853 , 42.736 ],
 [ 9.116 ,  0.    , -2.497 , 38.994 ],
 [ 9.118 ,  0.    , -2.138 , 35.208 ],
 [ 9.142 ,  0.    , -1.832 , 31.942 ],
 [ 1.9091,  0.    , -1.801 , 56.689 ],
 [ 1.8801,  0.    , -2.152 , 58.02  ],
 [ 1.8841,  0.    , -2.502 , 59.216 ],
 [ 1.8833,  0.    , -2.861 , 60.646 ],
 [ 1.8618,  0.    , -3.167 , 63.116 ],
 [ 2.6941,  0.    , -1.872 , 44.149 ],
 [ 3.0696,  0.    , -1.882 , 42.417 ],
 [ 3.442 ,  0.    , -1.885 , 40.802 ],
 [ 3.8099,  0.    , -1.885 , 39.424 ],
 [ 4.175 ,  0.    , -1.885 , 38.249 ],
 [ 8.815 ,  0.    , -1.91  , 32.861 ],
 [ 4.539 ,  0.    , -1.885 , 37.245 ],
 [ 8.448 ,  0.    , -1.885 , 32.704 ],
 [ 4.902 ,  0.    , -1.885 , 36.391 ],
 [ 8.094 ,  0.    , -1.885 , 32.853 ],
 [ 5.264 ,  0.    , -1.885 , 35.667 ],
 [ 5.624 ,  0.    , -1.885 , 35.06  ],
 [ 7.734 ,  0.    , -1.885 , 33.029 ],
 [ 7.375 ,  0.    , -1.885 , 33.238 ],
 [ 7.019 ,  0.    , -1.885 , 33.491 ],
 [ 6.669 ,  0.    , -1.885 , 33.789 ],
 [ 6.323 ,  0.    , -1.885 , 34.14  ],
 [ 5.976 ,  0.    , -1.885 , 34.557 ],
 [ 8.804 ,  0.    , -3.089 , 45.335 ],
 [ 2.1963,  0.    , -3.089 , 60.961 ],
 [ 8.429 ,  0.    , -3.115 , 45.781 ],
 [ 2.5722,  0.    , -3.115 , 59.433 ],
 [ 8.068 ,  0.    , -3.115 , 45.994 ],
 [ 2.9337,  0.    , -3.115 , 57.758 ],
 [ 7.704 ,  0.    , -3.115 , 46.254 ],
 [ 3.2995,  0.    , -3.115 , 56.156 ],
 [ 7.338 ,  0.    , -3.115 , 46.569 ],
 [ 3.666 ,  0.    , -3.115 , 54.676 ],
 [ 6.971 ,  0.    , -3.115 , 46.946 ],
 [ 4.033 ,  0.    , -3.115 , 53.33  ],
 [ 6.605 ,  0.    , -3.115 , 47.393 ],
 [ 4.399 ,  0.    , -3.115 , 52.121 ],
 [ 4.766 ,  0.    , -3.115 , 51.044 ],
 [ 5.133 ,  0.    , -3.115 , 50.095 ],
 [ 5.501 ,  0.    , -3.115 , 49.264 ],
 [ 5.869 ,  0.    , -3.115 , 48.543 ],
 [ 6.237 ,  0.    , -3.115 , 47.922 ],
 [ 8.808 ,  0.    , -2.684 , 41.088 ],
 [ 8.81  ,  0.    , -2.317 , 37.199 ],
 [ 2.1915,  0.    , -2.33  , 53.485 ],
 [ 2.1939,  0.    , -2.682 , 56.44  ],
 [ 2.4715,  0.    , -2.149 , 48.827 ],
 [ 2.8538,  0.    , -2.189 , 47.427 ],
 [ 3.2436,  0.    , -2.197 , 45.616 ],
 [ 3.6194,  0.    , -2.199 , 44.07  ],
 [ 3.988 ,  0.    , -2.199 , 42.744 ],
 [ 4.353 ,  0.    , -2.199 , 41.602 ],
 [ 8.564 ,  0.    , -2.173 , 35.752 ],
 [ 4.717 ,  0.    , -2.199 , 40.618 ],
 [ 8.263 ,  0.    , -2.196 , 36.129 ],
 [ 5.08  ,  0.    , -2.199 , 39.772 ],
 [ 5.441 ,  0.    , -2.199 , 39.051 ],
 [ 7.911 ,  0.    , -2.199 , 36.336 ],
 [ 7.553 ,  0.    , -2.199 , 36.559 ],
 [ 7.195 ,  0.    , -2.199 , 36.825 ],
 [ 6.842 ,  0.    , -2.199 , 37.137 ],
 [ 6.493 ,  0.    , -2.199 , 37.504 ],
 [ 6.145 ,  0.    , -2.199 , 37.935 ],
 [ 5.796 ,  0.    , -2.199 , 38.445 ],
 [ 8.553 ,  0.    , -2.827 , 42.705 ],
 [ 2.4495,  0.    , -2.825 , 56.91  ],
 [ 8.246 ,  0.    , -2.806 , 42.637 ],
 [ 2.7671,  0.    , -2.805 , 55.073 ],
 [ 7.889 ,  0.    , -2.806 , 42.85  ],
 [ 3.1374,  0.    , -2.805 , 53.347 ],
 [ 7.526 ,  0.    , -2.806 , 43.121 ],
 [ 3.5066,  0.    , -2.806 , 51.779 ],
 [ 7.162 ,  0.    , -2.806 , 43.445 ],
 [ 3.8741,  0.    , -2.806 , 50.373 ],
 [ 6.798 ,  0.    , -2.806 , 43.832 ],
 [ 4.241 ,  0.    , -2.806 , 49.12  ],
 [ 4.607 ,  0.    , -2.806 , 48.013 ],
 [ 4.973 ,  0.    , -2.806 , 47.04  ],
 [ 5.339 ,  0.    , -2.806 , 46.193 ],
 [ 5.704 ,  0.    , -2.806 , 45.46  ],
 [ 6.069 ,  0.    , -2.806 , 44.829 ],
 [ 6.434 ,  0.    , -2.806 , 44.29  ],
 [ 2.1471,  0.    , -2.04  , 52.767 ],
 [ 8.48  ,  0.    , -2.501 , 39.283 ],
 [ 2.544 ,  0.    , -2.492 , 52.726 ],
 [ 3.0022,  0.    , -2.502 , 50.45  ],
 [ 3.3995,  0.    , -2.507 , 48.713 ],
 [ 3.7757,  0.    , -2.508 , 47.237 ],
 [ 4.144 ,  0.    , -2.508 , 45.958 ],
 [ 4.51  ,  0.    , -2.508 , 44.844 ],
 [ 4.874 ,  0.    , -2.508 , 43.875 ],
 [ 5.237 ,  0.    , -2.508 , 43.038 ],
 [ 8.09  ,  0.    , -2.507 , 39.543 ],
 [ 7.727 ,  0.    , -2.508 , 39.784 ],
 [ 7.367 ,  0.    , -2.508 , 40.056 ],
 [ 7.009 ,  0.    , -2.508 , 40.376 ],
 [ 6.655 ,  0.    , -2.508 , 40.753 ],
 [ 6.302 ,  0.    , -2.508 , 41.195 ],
 [ 5.95  ,  0.    , -2.508 , 41.714 ],
 [ 5.595 ,  0.    , -2.508 , 42.323 ]]
)
#Soil domain
Tresca_1 = prj.Tresca(
    name='Tresca_1',
    color=rgb(195,105,54),
    Eu=E,
    cu= cu_map,   
    gamma_dry= 18,
    gamma_sat= 20,                  
    )
#Selecting soil domain
SoilFace = model2d.select(p0=[1,-1],types='face')
#Setting 
model2d.set_solid(shapes=SoilFace,material=Tresca_1)
#Rigid footing
RigidMaterial = prj.Rigid(name="Rigid1",
       color=rgb(r=108,g=136,b=160),
       )
f = model2d.select(p0=[1,1],types=['face'])
model2d.set_solid(shapes=f,material=RigidMaterial)

#Surcharge
model2d.set_surface_load(shapes=model2d.select(p0=[0.01,1],types='edge'),
                         value=q,
                         direction='y',
                         coordinate_type= 'local',
                         option='multiplier')
"""Supports"""
#Set standard supports
model2d.set_standard_fixities()

"""Analysis"""
#Define analysis parameters
stage1.set_analysis_properties(
                analysis_type= 'load_multiplier',
                element_type='mixed',
                no_of_elements=5000,
                mesh_adaptivity='yes',
                adaptivity_iterations=3,
                )
#Begin analysis
prj.run_analysis()

"""Output"""
res = [stage1.output.global_results.load_multiplier]
print("Bearing capacity:", round(res[0],ndigits=5),"kN/m^2")
#Zoom and center model
model2d.zoom_all()
